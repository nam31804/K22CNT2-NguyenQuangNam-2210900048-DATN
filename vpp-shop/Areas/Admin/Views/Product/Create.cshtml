@{
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}
@model vpp_shop.Models.Product

<h1 class="h3 mb-4 text-gray-800">Thêm sản phẩm</h1>

<div class="card shadow mb-4">
    <div class="card-body">
        <form asp-area="Admin"
              asp-controller="Product"
              asp-action="Create"
              method="post"
              enctype="multipart/form-data">

            @Html.AntiForgeryToken()

            <!-- DANH MỤC -->
            <div class="mb-3">
                <label class="form-label fw-bold">Danh mục</label>
                <select asp-for="CategoryId" class="form-select">
                    <option value="0">-- Chọn thể loại --</option>
                    @foreach (var c in ViewBag.Categories)
                    {
                        <option value="@c.Id">@c.Name</option>
                    }
                </select>

                <span class="text-danger">
                    @Html.ValidationMessageFor(m => m.CategoryId)
                </span>
            </div>

            <!-- TÊN -->
            <div class="mb-3">
                <label class="form-label fw-bold">Tên sản phẩm</label>
                <input asp-for="Name"
                       class="form-control"
                       placeholder="Nhập tên sản phẩm"
                       required />
            </div>

            <!-- GIÁ -->
            <div class="mb-3">
                <label class="form-label fw-bold">Giá (VNĐ)</label>
                <input asp-for="Price"
                       type="number"
                       step="0.01"
                       class="form-control"
                       placeholder="Ví dụ: 20000"
                       required />
            </div>

            <!-- SỐ LƯỢNG -->
            <div class="mb-3">
                <label class="form-label fw-bold">Số lượng tồn</label>
                <input asp-for="Stock"
                       type="number"
                       class="form-control"
                       value="0" />
            </div>

            <!-- ✅ MÔ TẢ (THÊM MỚI) -->
            <div class="mb-3">
                <label class="form-label fw-bold">Mô tả sản phẩm</label>
                <textarea asp-for="Description"
                          class="form-control"
                          rows="4"
                          placeholder="Nhập mô tả sản phẩm..."></textarea>
            </div>

            <!-- ẢNH ĐẠI DIỆN -->
            <div class="mb-4">
                <label class="form-label fw-bold">Ảnh đại diện</label>

                <input type="file"
                       id="imageFile"
                       name="imageFile"
                       accept="image/*"
                       hidden
                       onchange="handleImageChange(this)" />

                <div id="uploadBox"
                     onclick="document.getElementById('imageFile').click()"
                     class="border rounded d-flex align-items-center justify-content-center text-muted"
                     style="width:100%;height:180px;cursor:pointer;overflow:hidden;background:#fafafa">

                    <div id="uploadPlaceholder" class="text-center">
                        <i class="fas fa-cloud-upload-alt fa-2x mb-2"></i>
                        <div>Bấm vào đây để chọn ảnh</div>
                        <small>(JPG, PNG)</small>
                    </div>

                    <img id="previewImage"
                         style="display:none;max-width:100%;max-height:100%;object-fit:contain;" />
                </div>
            </div>

            <!-- BUTTON -->
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary px-4">
                    <i class="fas fa-save me-1"></i> Lưu
                </button>

                <a asp-area="Admin"
                   asp-controller="Product"
                   asp-action="Index"
                   class="btn btn-secondary px-4">
                    Quay lại
                </a>
            </div>
        </form>
    </div>
</div>

<script>
    function handleImageChange(input) {
        if (input.files && input.files[0]) {
            const preview = document.getElementById('previewImage');
            const placeholder = document.getElementById('uploadPlaceholder');

            preview.src = URL.createObjectURL(input.files[0]);
            preview.style.display = 'block';
            placeholder.style.display = 'none';
        }
    }
</script>
